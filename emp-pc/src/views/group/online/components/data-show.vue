<style lang="less">    @import './online-data.less';</style><style  lang="less">    @import "../../../../styles/fonts/iconfont.css";</style><template>    <div class="device-data">        <search-wrapper  :pageNow ='pageNow' @initPage="initPage" @chartInfo="chartInfo" @getAreaGo = 'getAreaGo' :theName="theName"></search-wrapper>        <div class="device-wrapper">            <Card  :key="index" v-for="(item,index) in theOnlineListInfo.dataList"                   :class="{'out-online':item.head ==1,                   'normal':item.head==0,                   'card-style':true,                   'out-against':item.head==2 }">                <p slot="title" class="top">                    <!--<Icon type="ios-film-outline"></Icon>-->                    <span>{{item.deviceName}}</span>                    <span v-if="!item.deviceOut" class="icon-list">                        <span class="icon-item" v-if="item.socketOn"><img  src="../../../../images/on.png" alt=""></span>                        <span class="icon-item"  v-if="item.socketDisOn"><img   src="../../../../images/out.png" alt=""></span>                    </span>                    <span class="icon"><img src="../../../../images/bat.png" alt=""></span>                </p>                <ul class="atr-list">                    <li>                        <div class="atr-icon">                            <img src="../../../../images/tem.jpg" alt="">                        </div>                        <div class="atr-temp">                            <span :class="{'atr-temp-red':item.hum}">湿度：{{item.humidity}}%RH</span>                            <span>预警范围：{{item.humidityLow}}-{{item.humidityHigh}}%RH</span>                        </div>                    </li>                    <li>                        <div class="atr-icon">                            <img src="../../../../images/him.jpg" alt="">                        </div>                        <div class="atr-temp">                            <span :class="{'atr-temp-red':item.tem}">温度：{{item.temperature}}℃</span>                            <span>预警范围：{{item.temperatureLow}}-{{item.temperatureHigh}}℃</span>                        </div>                    </li>                </ul>                <div class="switch-change" >                    <span class="switch-change-one">DO1&nbsp;&nbsp;<i-switch @on-change="doContrl(item,1,item.do1)" v-model="item.do1" :disabled="item.deviceType!=1"></i-switch></span>                    <span class="switch-change-one">DO2&nbsp;&nbsp;<i-switch @on-change="doContrl(item,2,item.do2)" v-model="item.do2"  :disabled="item.deviceType!=1"></i-switch></span>                </div>            </Card>            <Page :total="totalPage" :page-size = "10" :current="pageNow+1" @on-change="changePage" v-if="theOnlineListInfo.dataList!=undefined&&theOnlineListInfo.dataList.length>0"/>        </div>    </div></template><script>  import searchWrapper from '../../components/search-wrapper.vue'  import {mapState, mapMutations} from 'vuex';    export default {      name:"deviceData",      props:['theName'],      data(){        return{          totalPage:0,          pageNow:0,          theOnlineListInfo:{},          choosedAreaInfo:{}        }      },      components:{        searchWrapper      },      computed:{        ...mapState({          theUrl: state => state.user.theUrl        })      },      methods:{        initPage(it){          this.pageNow = it        },        changePage(it){            this.pageNow = it-1        },        /*更改继电器*/        doContrl(it,w,d){          let userId = this.$cookie.get('userId');          let accessToken = this.$cookie.get('accessToken');          let permissions = this.$cookie.get('permissions');          var doControl = d?0:1;          let data = {            sn:it.sn,            doNum:w,            doControl:doControl,            userId:userId,            loginType:2,            accessToken:accessToken,            permissions:permissions          };          this.$http({            method:'post',            url:this.$util.ajaxUrl+"/public/doControl",            data          },(res)=>{            let result = res.data;            if(result.code==0){              this.$Message.success(res.data.msg)            }else{              this.$Message.error(res.data.msg)            }          },(erro)=>{            console.log(erro);          })        },        getAreaGo(it){          this.choosedAreaInfo = it;        },        chartInfo(it){          const _this = this;          this.theOnlineListInfo = it;          this.totalPage = it.count;          if(this.theOnlineListInfo.dataList.length==0){            this.$Message.info('该区域没有设备');            return          };          this.theOnlineListInfo.dataList.forEach(function(val,index){            val.do1==0 ? val.do1 = true : val.do1 = false;            val.do2==0 ? val.do2 = true : val.do2 = false;            if(val.warning!=''){              val.warning =JSON.parse("["+val.warning+"]");            };            //head  头部为0时候正常，1为灰色，2为红色            //socketDisOn 断开的插座状态 false为隐藏 true为显示            //socketOn 连接的插座状态  false为隐藏 true为显示            //tem 温度状态  false为正常  true为不正常            //hum 湿度 false为正常  true为不正常            //deviceOut 设备在线状态 false为在线 true 为离线            // warning 1,2是温度；3，4是湿度；12是电量            val.tem = false;            val.hum = false;            val.socketOn = false;            val.socketDisOn = false;            val.head = 0;            val.deviceOut = false;            if(val.status==1){              val.deviceOut = true              val.head = 1;            }else if(val.status==0){              val.deviceOut = false;              if(val.warning.length!=0){                val.head = 2;              };              if(val.isOutages=='0'){                val.socketOn = true;                if(val.warning.indexOf(12)!=-1){                  val.socketDisOn = true;                  val.socketOn = false;                }              };              if(val.warning.indexOf(1)!=-1||val.warning.indexOf(2)!=-1){                val.tem = true;              }              if(val.warning.indexOf(3)!=-1||val.warning.indexOf(4)!=-1){                val.hum = true              }            }          })          console.log(this.theOnlineListInfo)        },      }    }</script>