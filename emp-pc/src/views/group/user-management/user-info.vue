<style lang="less">    .info-list{        padding: 0 10px;        box-sizing: border-box;        li{            min-height: 40px;            margin-top: 10px;            height: auto;            display: flex;            .the-btn{                width: 100%;                padding: 30px 30px;                box-sizing: border-box;            }            .list-first{                width: 130px;                text-align: right;                padding-right: 20px;                box-sizing: border-box;                display: inline-block;                line-height: 40px;            }            .list-last{                flex: 1;                display: inline-block;                line-height: 40px;                text-align: left;            }        }    }</style><template>    <div class="user-info">        <Card style="width:600px;text-align: center;margin: 0 auto;">            <ul class="info-list">                <li>                    <span class="list-first">账号：</span>                    <span class="list-last">{{personalInfo.account}}</span>                </li>                <li>                    <span class="list-first">短信条数：</span>                    <span class="list-last">{{personalInfo.msgNum}}条</span>                </li>                <li>                    <span class="list-first">数据延长时间：</span>                    <span class="list-last">{{personalInfo.historyDate}}月</span>                </li>                <li>                    <span class="list-first">服务时间：</span>                    <span class="list-last">{{personalInfo.endTime}}</span>                </li>                <li>                    <span class="list-first">名称：</span>                    <span class="list-last">                        <Input v-model="personalInfo.name" placeholder="请输入公司名称." ></Input>                    </span>                </li>                <li>                    <span class="list-first">地址：</span>                    <span class="list-last">                        <Input v-model="personalInfo.address" placeholder="请输入公司地址"></Input>                    </span>                </li>                <li>                    <span class="list-first">手机号码：</span>                    <span class="list-last">                        <span>{{personalInfo.phone}}</span>                         <Button type="primary" size="small" @click="changeMobileModal=true">更改</Button>                    </span>                </li>                <li>                    <span class="the-btn">                        <Button type="primary"  html-type="submit" long>保存</Button>                    </span>                </li>            </ul>        </Card>        <Modal v-model="changeMobileModal" title="更改手机号">            <div>                <Form ref="formValidate" :model="formValidate" :rules="ruleValidate" :label-width="80">                    <FormItem label="旧手机号">                        <span>{{personalInfo.account}}</span>                    </FormItem>                    <FormItem label="新手机号" prop="phone">                        <Input v-model="formValidate.phone" :maxlength='11' placeholder="输入手机号"></Input>                    </FormItem>                    <FormItem label="验证码" prop="code">                        <Input v-model="formValidate.code" :maxlength='6' placeholder="输入验证码">                            <span slot="append"> <Button type="primary" size="small" @click="getCode" :disabled="canNotGetCode">{{codeText}}</Button></span>                        </Input>                    </FormItem>                </Form>            </div>            <div slot="footer">                <Button type="primary" @click="changePhone('formValidate')">确认</Button>                <Button @click="changeMobileModal=false">取消</Button>            </div>        </Modal>    </div></template><script>    let _from = ''  export default {    name: 'userInfo',    data(){      const validatePhone =  (rule, value, callback) => {        var myreg=/^[1][3,4,5,7,8][0-9]{9}$/;        if (value === '') {          callback(new Error('请输入手机号'));        } else {          if (!myreg.test(value)) {            callback(new Error('请输入正确手机号'));          }else{            callback();          }        }      };      const validateCode =  (rule, value, callback) => {        var myreg=/^[0-9]{6}$/;        if (value === '') {          callback(new Error('请输入验证码'));        } else {          if (!myreg.test(value)) {            callback(new Error('请输入6位数字'));          }else{            callback();          }        }      };      return {        userId:'',        accessToken:'',        permissions:'',        personalInfo:{},        value:'',        countdown:5,        codeText:'获取验证码',        canNotGetCode:false,        changeMobileModal:false,        formValidate:{          phone:'',          code:''        },        ruleValidate:{          phone: [            { validator: validatePhone, trigger: 'blur' },          ],          code: [            { validator: validateCode, trigger: 'blur' },          ]        }      }    },    beforeRouteEnter (to, from, next) {      _from = from.name      next()    },    mounted(){      this.accessToken = this.$cookie.get('accessToken');      this.permissions = this.$cookie.get('permissions');      if(_from == 'customer-data-index'){        this.userId = this.$route.query.userId;        alert(this.userId)      }else{        this.userId = this.$cookie.get('userId');      }      this.getPersonalInfo()    },    methods:{      //更改手机号      changePhone(name){        this.$refs[name].validate((valid) => {          if (valid) {            let data = {              phone:this.personalInfo.phone,              newPhone:this.formValidate.phone,              vcode:this.formValidate.code,              loginType:2,              userId:this.userId,              accessToken:this.accessToken,              permissions:this.permissions            };            this.$http({              method:'post',              url:this.$util.ajaxUrl+"/userInfo/updateUserPhone",              data            },(res)=>{              let result = res.data;              if(result.code==0){                this.changeMobileModal = false;                this.$Message.success("手机号更改成功！")              }else{                this.$Message.success(res.data.msg)              }            },(erro)=>{              console.log(erro);            })          }        });      },      settime() {        const _this = this;        if (this.countdown == 0) {          this.canNotGetCode = false;          this.codeText = '获取验证码';          this.countdown = 0;        } else {          this.canNotGetCode = true;          this.codeText = this.countdown + 's后获取验证码';          this.countdown--;        };        setTimeout(function() {          _this.settime()        },1000)      },      //获取验证码      getCode(){        if(this.formValidate.phone==''){          this.$Message.error("请先输入手机号！")          return        };        if(!this.canNotGetCode) {          this.settime()        }else{          return        };        let data = {          phone:this.formValidate.phone,          bizCode:3,          userId:this.userId,          loginType:2,          accessToken:this.accessToken,          permissions:this.permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/public/sendVcode",          data        },(res)=>{          if(res.data.code==0){            this.$Message.success("验证码获取成功")          }else{            this.$Message.error(res.data.msg)          }        },(erro)=>{          console.log(erro);        })      },      //获取个人信息      getPersonalInfo(){        let data = {          userId:this.userId,          loginType:2,          accessToken:this.accessToken,          permissions:this.permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/userInfo/selectUserInfo",          data        },(res)=>{          let result = res.data;          if(result.code==0){            this.personalInfo = result.data;          }else{            this.$Message.success(res.data.msg)          }        },(erro)=>{          console.log(erro);        })      }    }  };</script>