<style lang="less">    .info-list{        padding: 0 10px;        box-sizing: border-box;        li{            min-height: 40px;            margin-top: 10px;            height: auto;            display: flex;            .the-btn{                width: 100%;                padding: 30px 30px;                box-sizing: border-box;            }            .list-first{                width: 130px;                text-align: right;                padding-right: 20px;                box-sizing: border-box;                display: inline-block;                line-height: 40px;            }            .list-last{                flex: 1;                display: inline-block;                line-height: 40px;                text-align: left;            }        }    }</style><template>    <div class="user-info">        <Card style="width:600px;text-align: center;margin: 0 auto;">            <ul class="info-list">                <li>                    <span class="list-first">{{lang.account}}：</span>                    <span class="list-last">{{personalInfo.account}}</span>                </li>                <li>                    <span class="list-first">{{lang.messageNum}}：</span>                    <span class="list-last">{{personalInfo.msgNum}}条</span>                </li>                <li>                    <span class="list-first">{{lang.extensionTime}}：</span>                    <span class="list-last">{{personalInfo.historyDate}}{{lang.month}}</span>                </li>                <li>                    <span class="list-first">{{lang.serviceTime}}：</span>                    <span class="list-last">{{personalInfo.endTime}}</span>                </li>                <li>                    <span class="list-first">{{lang.name}}：</span>                    <span class="list-last">                        <Input v-model="personalInfo.name" :placeholder="lang.inCompanyName" ></Input>                    </span>                </li>                <li>                    <span class="list-first">{{lang.address}}：</span>                    <span class="list-last">                        <Input v-model="personalInfo.address" :placeholder="lang.inCompanyAddress"></Input>                    </span>                </li>                <li>                    <span class="list-first">{{lang.telephone}}：</span>                    <span class="list-last">                        <span>{{personalInfo.phone}}</span>                         <Button type="primary" size="small" @click="changeMobileModal=true">{{lang.change}}</Button>                    </span>                </li>                <li>                    <span class="the-btn">                        <Button type="primary" @click="saveInfo" html-type="submit" long>{{lang.save}}</Button>                    </span>                </li>            </ul>        </Card>        <Modal v-model="changeMobileModal" :title="lang.changeTelephone">            <div>                <Form ref="formValidate" :model="formValidate" :rules="ruleValidate" :label-width="80">                    <FormItem :label="lang.oldPhone">                        <span>{{personalInfo.account}}</span>                    </FormItem>                    <FormItem :label="lang.newPhone" prop="phone">                        <Input v-model="formValidate.phone" :maxlength='11' :placeholder="lang.inTelephone"></Input>                    </FormItem>                    <FormItem :label="lang.verificationCode" prop="code">                        <Input v-model="formValidate.code" :maxlength='6' :placeholder="lang.inVerificationCode">                            <span slot="append"> <Button type="primary" size="small" @click="getCode" :disabled="canNotGetCode">{{codeText}}</Button></span>                        </Input>                    </FormItem>                </Form>            </div>            <div slot="footer">                <Button type="primary" @click="changePhone('formValidate')">{{lang.confirm}}</Button>                <Button @click="changeMobileModal=false">{{lang.cancel}}</Button>            </div>        </Modal>    </div></template><script>    let _from = ''    import Cookies from 'js-cookie';  export default {    name: 'userInfo',    data(){      const _this = this;      const validatePhone =  (rule, value, callback) => {        var myreg=/^[1][3,4,5,7,8][0-9]{9}$/;        if (value === '') {          callback(new Error(_this.lang.inTelephone));        } else {          if (!myreg.test(value)) {            callback(new Error(_this.lang.inCorrectTelephone));          }else{            callback();          }        }      };      const validateCode =  (rule, value, callback) => {        var myreg=/^[0-9]{6}$/;        if (value === '') {          callback(new Error(_this.lang.inVerificationCode));        } else {          if (!myreg.test(value)) {            callback(new Error(_this.lang.inCorrectNum));          }else{            callback();          }        }      };      return {        userId:'',        accessToken:'',        permissions:'',        personalInfo:{},        value:'',        countdown:60,        codeText:'获取验证码',        canNotGetCode:false,        changeMobileModal:false,        formValidate:{          phone:'',          code:''        },        ruleValidate:{          phone: [            { validator: validatePhone, trigger: 'blur' },          ],          code: [            { validator: validateCode, trigger: 'blur' },          ]        }      }    },    beforeRouteEnter (to, from, next) {      _from = from.name      next()    },    computed: {      lang(){        if(this.$store.state.lang.is=='cn'){        }else{        }        return this.$store.state.lang.userInfo      }    },    mounted(){      this.accessToken = this.$cookie.get('accessToken');      this.permissions = this.$cookie.get('permissions');      if(_from == 'customer-data-index'){        this.userId = this.$route.query.userId;        alert(this.userId)      }else{        this.userId = this.$cookie.get('userId');      }      this.getPersonalInfo()    },    methods:{      //保存更改      saveInfo(){        let userId = this.$cookie.get('userId');        let accessToken = this.$cookie.get('accessToken');        let permissions = this.$cookie.get('permissions');        let data = {          name:this.personalInfo.name,          address:this.personalInfo.address,          userId:userId,          loginType:2,          accessToken:accessToken,          permissions:permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/userInfo/updateUserInfo",          data        },(res)=>{          let result = res.data;          if(result.code==0){            this.$Message.success(res.data.msg);            Cookies.set('companyName', this.personalInfo.name);            window.location.reload();          }else{            this.$Message.error(res.data.msg)          }        },(erro)=>{          console.log(erro);        })      },      //更改手机号      changePhone(name){        const _this = this;        this.$refs[name].validate((valid) => {          if (valid) {            let data = {              phone:this.personalInfo.phone,              newPhone:this.formValidate.phone,              vcode:this.formValidate.code,              loginType:2,              userId:this.userId,              accessToken:this.accessToken,              permissions:this.permissions            };            this.$http({              method:'post',              url:this.$util.ajaxUrl+"/userInfo/updateUserPhone",              data            },(res)=>{              let result = res.data;              if(result.code==0){                this.changeMobileModal = false;                this.$Message.success(_this.lang.success)              }else{                this.$Message.success(res.data.msg)              }            },(erro)=>{              console.log(erro);            })          }        });      },      settime() {        const _this = this;        if (this.countdown == 0) {          this.canNotGetCode = false;          this.codeText = '获取验证码';          this.countdown = 0;        } else {          this.canNotGetCode = true;          this.codeText = this.countdown + 's后获取验证码';          this.countdown--;        };        setTimeout(function() {          _this.settime()        },1000)      },      //获取验证码      getCode(){        const _this = this;        if(this.formValidate.phone==''){          this.$Message.error(_this.lang.inTelephone)          return        };        if(!this.canNotGetCode) {          this.settime()        }else{          return        };        let data = {          phone:this.formValidate.phone,          bizCode:3,          userId:this.userId,          loginType:2,          accessToken:this.accessToken,          permissions:this.permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/public/sendVcode",          data        },(res)=>{          if(res.data.code==0){            this.$Message.success(_this.lang.success)          }else{            this.$Message.error(res.data.msg)          }        },(erro)=>{          console.log(erro);        })      },      //获取个人信息      getPersonalInfo(){        let data = {          userId:this.userId,          loginType:2,          accessToken:this.accessToken,          permissions:this.permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/userInfo/selectUserInfo",          data        },(res)=>{          let result = res.data;          if(result.code==0){            this.personalInfo = result.data;          }else{            this.$Message.success(res.data.msg)          }        },(erro)=>{          console.log(erro);        })      }    }  };</script>