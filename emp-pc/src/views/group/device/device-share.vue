<style lang="less">    .table-list{        padding:20px 0;        box-sizing: border-box;    }    .pages{        padding: 20px 0;        box-sizing: border-box;        text-align: right;    }</style><template>    <div class="device-share">       <div>           <Input v-model="sharedAccount" :placeholder="lang.inSearch" style="width: 300px"></Input>           <Button type="primary" @click="initMyShareAccount(0)">{{lang.search}}</Button>       </div>        <div class="table-list">            <Table :columns="myShareAccountColumns" :page-size = "15" :data="myShareAccountList"></Table>        </div>        <div class="pages">            <Page :total="devicesListPage"  :current = "devicesListCurrent+1" :page-size='15' @on-change="goPage"></Page>        </div>        <Modal v-model="modal1" :title="sharedAccountName">            <div>                <div>                    <Input v-model="deviceName" :placeholder="lang.inDeviceAccount" style="width: 300px"></Input>                    <Button type="primary" @click="queryDeviceDetail(0)" >{{lang.search}}</Button>                </div>                <div  class="table-list">                    <Table :columns="myShareDeviesColumns" :data="myShareDeviesList"></Table>                    <div class="pages">                        <Page :total="myShareDevicesListPage"  :current = "myShareAccountPage+1" :page-size = "10"  @on-change="goPage1"></Page>                    </div>                </div>            </div>            <div slot="footer"></div>        </Modal>        <Modal :title="delState==0? lang.delThisAccount: lang.delThisDevice" v-model="modal2"  @on-ok='deleIt' @on-cancel='modal2=false' :mask-closable="true">            <p>{{delState==0? lang.delThisAccount : lang.delThisDevice}}</p>        </Modal>    </div></template><script>  export default {    name: 'deviceShare',    computed: {      lang(){        if(this.$store.state.lang.is=='cn'){          this.myShareDeviesColumns = this.myShareDeviesColumns1          this.myShareAccountColumns = this.myShareAccountColumns1        }else{          this.myShareDeviesColumns = this.myShareDeviesColumns2          this.myShareAccountColumns = this.myShareAccountColumns2        }        return this.$store.state.lang.myShareDevices      }    },    data(){      return{        is:'',        myShareDevicesListPage:0,        devicesListPage:0,        myShareDeviesList:[],        devicesListCurrent:0,        myShareAccountList:[],        myShareAccountPage:0,        delAccount:{},        delDevice:{},        delState:0,        checkAccount:{},        deviceName:'',        sharedAccount:'',        sharedAccountName:'',        modal1:false,        modal2:false,        myShareAccountColumns:[],        myShareAccountColumns1: [          {title: '分享的账号', key: 'sharedAccount'},          {title: '分享的设备总数', key: 'deviceCount'},          {title: '操作', key: 'action', fixed: 'right', width: 120,            render: (h, params) => {              return h('div', [                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on:{                    click: () => {                      this.checkIt(params.row)                    }                  }                }, '查看'),                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on:{                    click: () => {                      this.modal2 = true;                      this.delState = 0;                      this.delAccount = params.row;                    }                  }                }, '删除')              ]);            }          }        ],        myShareAccountColumns2: [          {title: 'Shared accounts', key: 'sharedAccount'},          {title: 'Total number of devices to share', key: 'deviceCount'},          {title: 'operation', key: 'action', fixed: 'right', width: 120,            render: (h, params) => {              return h('div', [                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on:{                    click: () => {                      this.checkIt(params.row)                    }                  }                }, 'check'),                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on:{                    click: () => {                      this.modal2 = true;                      this.delState = 0;                      this.delAccount = params.row;                    }                  }                }, 'delete')              ]);            }          }        ],        myShareDeviesColumns:[],        myShareDeviesColumns1: [          {            title: '设备SN号',            key: 'sn'          },          {            title: '设备名称',            key: 'deviceName'          },          {title: '操作', key: 'action', fixed: 'right', width: 120,            render: (h, params) => {              return h('div', [                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on:{                    click: () => {                      this.modal2 = true;                      this.delState = 1;                      this.delDevice = params.row;                    }                  }                }, '删除')              ]);            }          }        ],        myShareDeviesColumns2: [          {            title: 'device SN',            key: 'sn'          },          {            title: 'Device name',            key: 'deviceName'          },          {title: 'operation', key: 'action', fixed: 'right', width: 120,            render: (h, params) => {              return h('div', [                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on:{                    click: () => {                      this.modal2 = true;                      this.delState = 1;                      this.delDevice = params.row;                    }                  }                }, 'delete')              ]);            }          }        ]      }    },    mounted(){      this.initMyShareAccount(0)    },    watch:{      devicesListCurrent(newVal,oldVal){        this.initMyShareAccount(newVal)      },      myShareAccountPage(newVal,oldVal){        this.queryDeviceDetail(newVal)      }    },    methods:{      goPage1(it){        this.myShareAccountPage = it-1;      },      goPage(it){        this.devicesListCurrent = it-1;      },      //删除分享给我的设备      deleteMyShareDevice(it){        let userId = this.$cookie.get('userId');        let accessToken = this.$cookie.get('accessToken');        let permissions = this.$cookie.get('permissions');        const _this = this;        let data = {          sharedUserId:this.checkAccount.sharedUserId,          sn:it.sn,          type:0,          userId:userId,          loginType:2,          accessToken:accessToken,          permissions:permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/shared/deleteMySharedDevice",          data        },(res)=>{          if(res.data.code==0){            this.$Message.success(_this.lang.delSuccess)            this.queryDeviceDetail(0)          }        },(erro)=>{          console.log(erro);        })      },      //删除我分享的账号      delMyShareAccount(it){        const _this = this;        let userId = this.$cookie.get('userId');        let accessToken = this.$cookie.get('accessToken');        let permissions = this.$cookie.get('permissions');        let data = {          sharedUserId:it.sharedUserId,          // sharedUserId:this.checkAccount.sharedUserId,          type:0,          userId:userId,          loginType:2,          accessToken:accessToken,          permissions:permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/shared/deleteMyshared",          data        },(res)=>{          this.$Message.success(_this.lang.delSuccess)          this.initMyShareAccount(0)        },(erro)=>{          console.log(erro);        })      },      //查看我分享的设备列表详情      queryDeviceDetail(page){        let userId = this.$cookie.get('userId');        let accessToken = this.$cookie.get('accessToken');        let permissions = this.$cookie.get('permissions');        let data = {          sharedUserId:this.checkAccount.sharedUserId,          deviceName:this.deviceName,          type:0,          rows:10,          page:page,          userId:userId,          loginType:2,          accessToken:accessToken,          permissions:permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/shared/selectMysharedDevice",          data        },(res)=>{          this.sharedAccountName = "我分享给"+this.checkAccount.sharedAccount+"的设备"          let result = res.data.data;          this.myShareDeviesList = result.dataList;          this.myShareDevicesListPage = result.count        },(erro)=>{          console.log(erro);        })      },      //初始化设备列表      initMyShareAccount(page){        this.devicesListCurrent = page;        let userId = this.$cookie.get('userId');        let accessToken = this.$cookie.get('accessToken');        let permissions = this.$cookie.get('permissions');        let data = {          rows:15,          page:page,          type:0,          sharedAccount:this.sharedAccount,          userId:userId,          loginType:2,          accessToken:accessToken,          permissions:permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/shared/selectMyshared",          data        },(res)=>{          let result = res.data.data;           this.myShareAccountList = result.dataList;           this.devicesListPage = result.count;        },(erro)=>{          console.log(erro);        })      },      checkIt(it){        this.modal1 = true;        this.checkAccount = it        this.queryDeviceDetail(0)      },      deleIt(){        if(this.delState===0){          this.delMyShareAccount(this.delAccount)        }else if(this.delState==1){          this.deleteMyShareDevice(this.delDevice)        };        this.modal2 = false;      }    }  };</script>