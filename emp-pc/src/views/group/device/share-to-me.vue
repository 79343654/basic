<style lang="less">    .table-list{        padding:20px 0;        box-sizing: border-box;    }    .pages{        padding: 20px 0;        box-sizing: border-box;        text-align: right;    }</style><template>    <div class="share-to-me">        <div>            <Input v-model="sharedAccount" :placeholder="lang.inSearch" style="width: 300px"></Input>            <Button type="primary" @click="initShareToMeAccount(0)">{{lang.search}}</Button>        </div>        <div class="table-list">            <Table :columns="myShareAccountColumns" :data="shareToMeAccountList"></Table>        </div>        <div class="pages">            <Page :total="devicesListPage" :page-size="15"  :current = "shareToMeAccountPage+1"  @on-change="goPage"></Page>        </div>        <Modal v-model="modal1" :title="sharedAccountName">            <div>                <div>                    <Input v-model="deviceName" :placeholder="lang.inDeviceAccount" style="width: 300px"></Input>                    <Button type="primary" @click="queryDeviceDetail(0)">{{lang.search}}</Button>                </div>                <div  class="table-list">                    <Table :columns="myShareDeviesColumns" :data="shareToMeDeviesList"></Table>                    <div class="pages">                        <Page :total="shareToMeDevicesListPage" :page-size="10" :current = "shareToMeDeviesListPage+1" @on-change="goPage1"></Page>                    </div>                </div>            </div>            <div slot="footer"></div>        </Modal>        <Modal :title="delState==0?lang.delThisAccount: lang.delThisDevice" v-model="modal2"  @on-ok='deleIt' @on-cancel='modal2=false' :mask-closable="true">            <p>{{delState==0?lang.delThisAccount: lang.delThisDevice}}</p>        </Modal>    </div></template><script>  export default {    name: 'deviceShare',    computed: {      lang(){        if(this.$store.state.lang.is=='cn'){          this.myShareDeviesColumns = this.myShareDeviesColumns1          this.myShareAccountColumns = this.myShareAccountColumns1        }else{          this.myShareDeviesColumns = this.myShareDeviesColumns2          this.myShareAccountColumns = this.myShareAccountColumns2        }        return this.$store.state.lang.shareTome      }    },    data(){      return{        devicesListPage:0,        shareToMeDeviesListPage:0,        shareToMeAccountPage:0,        shareToMeDevicesListPage:0,        shareToMeDeviesList:[],        shareToMeAccountList:[],        delAccount:{},        delDevice:{},        delState:0,        checkAccount:{},        deviceName:'',        sharedAccount:'',        sharedAccountName:'',        modal1:false,        modal2:false,        myShareAccountColumns:[],        myShareAccountColumns1: [          {title: '分享给我的账号', key: 'sharedAccount'},          {title: '分享给我的设备总数', key: 'deviceCount'},          {title: '操作', key: 'action', fixed: 'right', width: 120,            render: (h, params) => {              return h('div', [                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on:{                    click: () => {                      this.checkIt(params.row)                    }                  }                }, '查看'),                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on:{                    click: () => {                      this.modal2 = true;                      this.delState = 0;                      this.delAccount = params.row;                    }                  }                }, '删除')              ]);            }          }        ],        myShareAccountColumns2: [          {title: 'Share my account number', key: 'sharedAccount'},          {title: 'The total number of devices shared to me', key: 'deviceCount'},          {title: 'operation', key: 'action', fixed: 'right', width: 120,            render: (h, params) => {              return h('div', [                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on:{                    click: () => {                      this.checkIt(params.row)                    }                  }                }, 'check'),                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on:{                    click: () => {                      this.modal2 = true;                      this.delState = 0;                      this.delAccount = params.row;                    }                  }                }, 'delete')              ]);            }          }        ],        myShareDeviesColumns:[],        myShareDeviesColumns1: [          {            title: '设备SN号',            key: 'sn'          },          {            title: '设备名称',            key: 'deviceName'          },          {title: '操作', key: 'action', fixed: 'right', width: 120,            render: (h, params) => {              return h('div', [                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on:{                    click: () => {                      this.modal2 = true;                      this.delState = 1;                      this.delDevice = params.row;                    }                  }                }, '删除')              ]);            }          }        ],        myShareDeviesColumns2: [          {            title: 'device SN',            key: 'sn'          },          {            title: 'Device name',            key: 'deviceName'          },          {title: 'operation', key: 'action', fixed: 'right', width: 120,            render: (h, params) => {              return h('div', [                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on:{                    click: () => {                      this.modal2 = true;                      this.delState = 1;                      this.delDevice = params.row;                    }                  }                }, 'delete')              ]);            }          }        ]      }    },    mounted(){      this.initShareToMeAccount(0)    },    methods:{      goPage(it){        this.shareToMeAccountPage = it-1;        this.initShareToMeAccount(it-1);      },      goPage1(it){        this.shareToMeDeviesListPage = it-1;        this.queryDeviceDetail(it-1);      },      //删除分享给我的设备      deleteSharedForMeDevice(it){        let userId = this.$cookie.get('userId');        let accessToken = this.$cookie.get('accessToken');        let permissions = this.$cookie.get('permissions');        const _this = this;        let data = {          sharedUserId:this.checkAccount.sharedUserId,          sn:it.sn,          type:0,          userId:userId,          loginType:2,          accessToken:accessToken,          permissions:permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/shared/deleteSharedForMeDevice",          data        },(res)=>{          if(res.data.code==0){            this.$Message.success(_this.lang.delSuccess);            this.queryDeviceDetail(0)          }        },(erro)=>{          console.log(erro);        })      },      //删除分享给我的账号      delShareToMeAccount(it){        let userId = this.$cookie.get('userId');        let accessToken = this.$cookie.get('accessToken');        let permissions = this.$cookie.get('permissions');        let data = {          sharedUserId:it.sharedUserId,          type:0,          userId:userId,          loginType:2,          accessToken:accessToken,          permissions:permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/shared/deleteSharedForMe",          data        },(res)=>{          this.$Message.success(_this.lang.delSuccess);          this.initShareToMeAccount(0)        },(erro)=>{          console.log(erro);        })      },      //查看分享给我的设备列表详情      queryDeviceDetail(page){        this.shareToMeDeviesListPage = page;        let userId = this.$cookie.get('userId');        let accessToken = this.$cookie.get('accessToken');        let permissions = this.$cookie.get('permissions');        let data = {          sharedUserId:this.checkAccount.sharedUserId,          deviceName:this.deviceName,          type:0,          rows:10,          page:page,          userId:userId,          loginType:2,          accessToken:accessToken,          permissions:permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/shared/selectSharedMeDevice",          data        },(res)=>{          this.sharedAccountName = "分享给我"+this.checkAccount.sharedAccount+"的设备"          let result = res.data.data;          this.shareToMeDeviesList = result.dataList;          this.shareToMeDevicesListPage = result.count        },(erro)=>{          console.log(erro);        })      },      //初始化设备列表      initShareToMeAccount(page){        this.shareToMeAccountPage = page;        let userId = this.$cookie.get('userId');        let accessToken = this.$cookie.get('accessToken');        let permissions = this.$cookie.get('permissions');        let data = {          rows:15,          page:page,          type:0,          sharedAccount:this.sharedAccount,          userId:userId,          loginType:2,          accessToken:accessToken,          permissions:permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/shared/selectSharedForMe",          data        },(res)=>{          let result = res.data.data;          this.shareToMeAccountList = result.dataList;          this.devicesListPage = result.count        },(erro)=>{          console.log(erro);        })      },      checkIt(it){        this.modal1 = true;        this.checkAccount = it        this.queryDeviceDetail(0)      },      deleIt(){        if(this.delState===0){          this.delShareToMeAccount(this.delAccount)        }else if(this.delState==1){          this.deleteSharedForMeDevice(this.delDevice)        };        this.modal2 = false;      }    }  };</script>