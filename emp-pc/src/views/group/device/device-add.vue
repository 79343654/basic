<style lang="less">    .device-list-table{        width:100%;        padding: 10px 0;        box-sizing: border-box;        .pages{            padding: 20px 0;            box-sizing: border-box;            text-align: right;        }    }    .inline-it{        display: inline-block;    }    .select-list{        .ivu-select-dropdown{            top:32px!important;        }    }    .edit-device{        .ivu-modal{            width: 1000px!important;            .limit-width{                width: 350px;            }        }    }</style><template>    <div class="device-add">        <!--            choosedDeviceList方法获取设备列表        -->        <top-search :pageNow = "pageNow" @initPage="initPage" @choosedDeviceList = "choosedDeviceList" ref="topSearch"></top-search>        <div class="device-list-table">            <Table :columns="columns" :data="deviceList"></Table>            <div class="pages">                <Page :total="totalPage" :page-size="15" :current="pageNow+1" @on-change="goPage"></Page>            </div>        </div>        <!--查询区域-->        <Modal v-model="deviceAreaModal" :title="lang.chooseArea" :mask-closable="false">            <div class="regional-list">                <Tree :data="allAreaList" @on-select-change="chooseToTheArea"></Tree>            </div>            <div slot="footer">                <Button @click="confirmChooseArea" type="primary"  size="default" >{{lang.comfirm}}</Button>            </div>        </Modal>        <!--设备分享-->        <Modal v-model="modal3" :title="lang.shareTitle">            <Form ref="shareDevice" :model="shareDevice" :rules="addDeviceValidate" :label-width="100">                <FormItem :label="lang.account" prop="account">                    <Input v-model="shareDevice.account" :placeholder="lang.placeHolderIn"></Input>                </FormItem>            </Form>            <div slot="footer">                <Button type="primary" size="default"  @click="shareSave('shareDevice')">{{lang.save}}</Button>            </div>        </Modal>        <!--设备编辑-->        <Modal v-model="modal2"  :title="lang.editDevice"  fullscreen  class="edit-device">            <div>                <Form ref="editDevice" :model="editDevice" :rules="addDeviceValidate1" :label-width="120">                    <FormItem :label="lang.deviceSn" prop="snName" class="limit-width inline-it">                       <span>{{editDevice.snName}}</span>                    </FormItem>                    <FormItem :label="lang.chooseArea" class="limit-width inline-it" prop="regionalName">                        <Input v-model="editDevice.regionalName" :placeholder="lang.placeHolderChooseArea"  @on-focus="changeThisDeviceArea" :clearable="true"></Input>                    </FormItem>                    <FormItem :label="lang.deviceName" prop="deviceName" class="limit-width  inline-it">                        <Input v-model="editDevice.deviceName" :placeholder="lang.placeHolderInDeviceName"></Input>                    </FormItem>                    <FormItem :label="lang.deviceInTime" prop="timeCode" class="limit-width  inline-it">                        <Select v-model="editDevice.timeCode" :placeholder="lang.placeHolderChooseIn">                                <Option :value="item.timeCode" :key="item.timeCode" v-for="item in timeList">{{item.timeCodeName}}</Option>                        </Select>                    </FormItem>                    <FormItem :label="lang.temperatureWarning" class="limit-width  inline-it">                        <Row>                            <Col span="8">                                <FormItem prop="temperatureLow">                                    <Input v-model="editDevice.temperatureLow"   :placeholder="lang.inTempetatureWaring" ></Input>                                </FormItem>                            </Col>                            <Col span="1" style="text-align: center"> - </Col>                            <Col span="8">                                <FormItem prop="temperatureHigh">                                    <Input v-model="editDevice.temperatureHigh"   :placeholder="lang.inTempetatureWaring"></Input>                                </FormItem>                            </Col>                        </Row>                    </FormItem>                    <FormItem :label="lang.humidityWarning" class="limit-width  inline-it">                        <Row>                            <Col span="8">                                <FormItem prop="humidityLow">                                 <Input v-model="editDevice.humidityLow"   :placeholder="lang.inhumidityWaring" class="input-width"></Input>                                </FormItem>                            </Col>                            <Col span="1" style="text-align: center"> - </Col>                            <Col span="8">                                <FormItem prop="humidityHigh">                                    <Input v-model="editDevice.humidityHigh"  :placeholder="lang.inhumidityWaring"  class="input-width"></Input>                                </FormItem>                            </Col>                        </Row>                    </FormItem>                    <br>                    <FormItem :label="lang.temperatureBuffer" class="limit-width inline-it"  prop="temperatureBuffer">                        <Input v-model="editDevice.temperatureBuffer"  :placeholder="lang.temperatureBufferIn" class="input-width"></Input>                    </FormItem>                    <FormItem :label="lang.humidityBuffer"  class="limit-width inline-it" prop="humidityBuffer">                        <Input v-model="editDevice.humidityBuffer"  :placeholder="lang.humidityBufferIn" class="input-width"></Input>                    </FormItem>                    <br>                    <FormItem :label="lang.realTimeReporting"  class="limit-width inline-it" prop="reportingInterval">                        <Input v-model="editDevice.reportingInterval"   :placeholder="lang.inRealTimeReporting" class="input-width"></Input>                    </FormItem>                    <FormItem :label="lang.recordeTimeGap"  class="limit-width inline-it" prop="recordInterval">                        <Input v-model="editDevice.recordInterval"   :placeholder="lang.inRecordeTimeGap" class="input-width"></Input>                    </FormItem>                    <br>                    <FormItem :label="lang.historyReportTime" prop="historyReportTime"  class="limit-width inline-it">                        <Input v-model="editDevice.historyReportTime" :placeholder="lang.inHistoryReportTime" class="input-width"></Input>                    </FormItem>                    <FormItem :label="lang.historyReportGap" prop="historyInterval"  class="limit-width inline-it">                        <Input v-model="editDevice.historyInterval"   :placeholder="lang.inHistoryReportGap" class="input-width"></Input>                    </FormItem>                    <br>                    <FormItem :label="lang.DO1Association" class="inline-it" prop="do1Associated" v-if="editDevice.deviceType==1">                        <Select v-model="editDevice.do1Associated"  multiple  style="width:260px">                            <Option v-for="item in editDevice.theDo1AssociatedList" :value="item.wrId" :key="item.wrId">{{ item.content }}</Option>                        </Select>                    </FormItem>                    <FormItem :label="lang.DO2Association"   class="inline-it" prop="do2Associated" v-if="editDevice.deviceType==1">                        <Select v-model="editDevice.do2Associated"  multiple  style="width:260px">                            <Option v-for="item in editDevice.theDo1AssociatedList" :value="item.wrId" :key="item.wrId">{{ item.content }}</Option>                        </Select>                    </FormItem>                    <FormItem :label="lang.DO1Style"  class="limit-width inline-it" prop="do1Type" v-if="editDevice.deviceType==1">                        <RadioGroup v-model="editDevice.do1Type">                            <Radio label="0">{{lang.alarm}}</Radio>                            <Radio label="1">{{lang.control}}</Radio>                        </RadioGroup>                    </FormItem>                    <FormItem :label="lang.DO1Init"  class="limit-width inline-it" v-if="editDevice.deviceType==1">                        <i-switch v-model="editDevice.do1Status" size="large" >                            <span slot="0">{{lang.open}}</span>                            <span slot="1">{{lang.close}}</span>                        </i-switch>                    </FormItem>                    <br>                    <FormItem :label="lang.DO2Style"  class="limit-width inline-it" prop="do2Type" v-if="editDevice.deviceType==1">                        <RadioGroup v-model="editDevice.do2Type" >                            <Radio label="0">{{lang.alarm}}</Radio>                            <Radio label="1">{{lang.control}}</Radio>                        </RadioGroup>                    </FormItem>                    <FormItem :label="lang.DO2Init"  class="limit-width inline-it" v-if="editDevice.deviceType==1">                        <i-switch v-model="editDevice.do2Status" size="large">                            <span slot="0">{{lang.open}}</span>                            <span slot="1">{{lang.close}}</span>                        </i-switch>                    </FormItem>                    <FormItem :label="lang.powerAlarm" >                        <i-switch v-model="editDevice.isOutages" size="large">                            <span slot="0">{{lang.open}}</span>                            <span slot="1">{{lang.close}}</span>                        </i-switch>                    </FormItem>                    <FormItem :label="lang.smsNotification" class="inline-it">                        <i-switch v-model="editDevice.isSms" size="large">                            <span slot="0">{{lang.open}}</span>                            <span slot="1">{{lang.close}}</span>                        </i-switch>                        <div v-if="editDevice.isSms">                            <div v-for="item in editDevice.smsList">                                <span>{{lang.contacts}}</span>                                <Input v-model="item.name" size="small" :placeholder="lang.InContactPerson" style="width: 100px"></Input>                                <span>{{lang.telephone}}</span>                                <Input v-model="item.phone" size="small" :placeholder="lang.InTelephone" style="width: 100px"></Input>                            </div>                        </div>                        <Button v-if="editDevice.isSms" size="small" @click="addContact(editDevice.smsList)"><Icon type="plus"></Icon></Button>                    </FormItem>                    <FormItem :label="lang.mainNote" class="inline-it">                        <i-switch v-model="editDevice.isEmail" size="large">                            <span slot="0">{{lang.open}}</span>                            <span slot="1">{{lang.close}}</span>                        </i-switch>                        <div v-if="editDevice.isEmail">                            <div  v-for="item in editDevice.emailList">                                <span>{{lang.contacts}}</span>                                <Input v-model="item.name" size="small" :placeholder="lang.inContacts"  style="width: 100px"></Input>                                <span>{{lang.mailbox}}</span>                                <Input v-model="item.email" size="small" :placeholder="lang.inMailbox" style="width: 100px"></Input>                            </div>                        </div>                        <Button v-if="editDevice.isEmail" size="small" @click="addEmail(editDevice.emailList)"><Icon type="plus"></Icon></Button>                    </FormItem>                </Form>            </div>            <div slot="footer">                <Button type="primary" size="large" long @click="editSave('editDevice')">{{lang.save}}</Button>            </div>        </Modal>        <Modal                v-model="delModal"                :title="lang.tips"                @on-ok="delOk"                @on-cancel="delCancel">            <p>{{lang.delTips}}？</p>        </Modal>    </div></template><script>  import topSearch from "./components/top-search"  export default {    name: 'deviceAdd',    components:{      topSearch    },    computed: {      lang(){        if(this.$store.state.lang.is=='cn'){          this.columns = this.columns1        }else{          this.columns = this.columns2        }        return this.$store.state.lang.deviceManage      }    },    watch:{      lang(){      }    },    data(){      const _this = this;      const canNoBeEmpty = (rule, value, callback) => {        if (value === ''||value === undefined) {          callback(new Error(_this.lang.canNotEmpty));        } else {          callback();        }      };      const temperatureHighVali =(rule, value, callback)=>{        if (value === ''||value === undefined) {          callback(new Error(_this.lang.canNotEmpty));        } else {          if(/^(\+|-)?\d+($|\.\d+$)/.test(value)){            if(value*1<-40||value*1>125){              callback(new Error(_this.lang.warningRange));            }else{              if(this.editDevice.temperatureHigh*1<this.editDevice.temperatureLow*1){                callback(new Error(_this.lang.incorrectSetting));              }else{                callback();              }            }          }else{            callback(new Error(_this.lang.onlyNum));          }        }      };      const temperatureLowVali = (rule, value, callback)=>{        if (value === ''||value === undefined) {          callback(new Error(_this.lang.canNotEmpty));        } else {          if(/^(\+|-)?\d+($|\.\d+$)/.test(value)){            if(value*1<-40||value*1>125){              callback(new Error(_this.lang.warningRange));            }else{              if(this.editDevice.temperatureHigh*1<this.editDevice.temperatureLow*1){                callback(new Error(_this.lang.incorrectSetting));              }else{                callback();              }            }          }else{            callback(new Error(_this.lang.onlyNum));          }        }      };      const humidityHighVali =(rule, value, callback)=>{        if (value === ''||value === undefined) {          callback(new Error(_this.lang.canNotEmpty));        } else {          if(/^(\+|-)?\d+($|\.\d+$)/.test(value)){            if(value*1<0.1||value*1>99.9){              callback(new Error(_this.lang.warningRange));            }else{              if(this.editDevice.humidityHigh*1<this.editDevice.humidityLow*1){                callback(new Error(_this.lang.incorrectSetting));              }else{                callback();              }            }          }else{            callback(new Error(_this.lang.onlyNum));          }        }      };      const humidityLowVali = (rule, value, callback)=>{        if (value === ''||value === undefined) {             callback(new Error(_this.lang.canNotEmpty));        } else {          if(/^(\+|-)?\d+($|\.\d+$)/.test(value)){            if(value*1<0.1||value*1>99.9){              callback(new Error(_this.lang.warningRange));            }else{              if(this.editDevice.humidityHigh*1<this.editDevice.humidityLow*1){                callback(new Error(_this.lang.incorrectSetting));              }else{                callback();              }            }          }else{            callback(new Error(_this.lang.onlyNum));          }        }      };      const temperatureBufferVali = (rule, value, callback)=>{        if (value === ''||value === undefined) {          callback(new Error(_this.lang.canNotEmpty));        } else {          if( /^[0-9]+.?[0-9]*$/.test(value)){            if(value*1<0||value*1>25){              callback(new Error(_this.lang.warningRange));            }else{                callback();            }          }else{            callback(new Error(_this.lang.onlyNum));          }        }      };      const humidityBufferVali = (rule, value, callback)=>{        if (value === ''||value === undefined) {          callback(new Error(_this.lang.canNotEmpty));        } else {          if( /^[0-9]+.?[0-9]*$/.test(value)){            if(value*1<0||value*1>25){              callback(new Error(_this.lang.warningRange));            }else{              callback();            }          }else{            callback(new Error(_this.lang.onlyNum));          }        }      };      const reportingIntervalVali = (rule, value, callback)=>{        if (value === ''||value === undefined) {          callback(new Error(_this.lang.canNotEmpty));        } else {          if(/^[0-9]*$/.test(value)){            if(value*1<0||value*1>1440){              callback(new Error(_this.lang.warningRange));            }else{              callback();            }          }else{            callback(new Error(_this.lang.onlyNum));          }        }      };      const recordIntervalVali = (rule, value, callback)=>{        if (value === ''||value === undefined) {          callback(new Error(_this.lang.canNotEmpty));        } else {          if(/^[0-9]*$/.test(value)){            if(value*1<0||value*1>1440){              callback(new Error(_this.lang.warningRange));            }else{              callback();            }          }else{            callback(new Error(_this.lang.onlyNum));          }        }      };      const historyReportTimeVali =  (rule, value, callback)=>{        if (value === ''||value === undefined) {          callback(new Error(_this.lang.canNotEmpty));        } else {          if(/^[0-9]*$/.test(value)){            if(value*1<0||value*1>24){              callback(new Error(_this.lang.warningRange));            }else{              callback();            }          }else{            callback(new Error(_this.lang.onlyNum));          }        }      };      return {        timeList:[],        pageNow:0,        totalPage:0,        deviceAreaModal:false,        allAreaList:[],        deviceChoosedArea:{},        deviceChoosedAreaTemp:{},        choosedShareDevice:{          sn:'',          deviceName:''        },        delSn:'',        delModal:false,        deviceList:[],        value:'',        modal2:false,        modal3:false,        shareDevice:{          account:''        },        editDevice:{},        addDeviceValidate:{          account:[            { required: true, message: '输入不能为空', trigger: 'blur' }          ]        },        addDeviceValidate1:{          regionalName: [            { required: true, validator: canNoBeEmpty,  trigger: 'change' }          ],          deviceName: [            { required: true, validator: canNoBeEmpty,  trigger: 'blur' }          ],          timeCode:[            { required: true, validator: canNoBeEmpty,  trigger: 'change' }          ],          do1Type:[            { required: true, validator: canNoBeEmpty,  trigger: 'change' }          ],          do2Type:[            { required: true, validator: canNoBeEmpty,  trigger: 'change' }          ],          humidityHigh:[            { required: true, validator: humidityHighVali,  trigger: 'blur' }          ],          humidityLow:[            { required: true, validator: humidityLowVali,  trigger: 'blur' }          ],          temperatureHigh:[            { required: true, validator: temperatureHighVali,  trigger: 'blur' }          ],          temperatureLow:[            { required: true, validator: temperatureLowVali,  trigger: 'blur' }          ],          account:[            { required: true, validator: canNoBeEmpty,  trigger: 'blur' }          ],          do1Associated:[            { required: true, validator: canNoBeEmpty,  trigger: 'change' }          ],          do2Associated:[            { required: true, validator: canNoBeEmpty,  trigger: 'change' }          ],          historyReportTime:[            { required: true, validator: canNoBeEmpty,  trigger: 'blur' }          ],          historyInterval:[            { required: true, validator: historyReportTimeVali,  trigger: 'blur' }          ],          temperatureBuffer:[            { required: true, validator: temperatureBufferVali,  trigger: 'blur' }          ],          humidityBuffer:[            { required: true, validator: humidityBufferVali,  trigger: 'blur' }          ],          reportingInterval:[            { required: true, validator: reportingIntervalVali,  trigger: 'blur' }          ],          recordInterval:[            { required: true, validator: recordIntervalVali,  trigger: 'blur' }          ],        },        modal1:false,        columns:[],        columns1: [          {title: '设备名称', key: 'deviceName',minWidth: 100},          {title: '设备SN号', key: 'sn',minWidth: 130},          {title: '温度预警范围', key: 'temperatureScope',minWidth: 80},          {title: '湿度预警范围', key: 'humidityScope',minWidth: 80},          {title: '历史上报间隔（小时）', key: 'historyInterval',minWidth: 80},          {title: '历史上报时刻', key: 'historyReportTime',minWidth: 80},          {title: '记录间隔', key: 'recordInterval',minWidth: 60},          {title: '上报间隔', key: 'reportingInterval',minWidth: 60},          {title: '所属区域', key: 'regionalName',minWidth: 150},          {title: '断电报警', key: 'isOutages',minWidth: 60,            render: (h, params) => {              var text = '';              switch (params.row.isOutages) {                case '0':                  text = '是';                  break;                case '1':                  text = '否';                  break;                default:                  text = '';                  break;              }              return h('span', text);            }          },          {title: '短信通知', key: 'isSms',minWidth: 60,            render: (h, params) => {              var text = '';              switch (params.row.isSms) {                case '0':                  text = '是';                  break;                case '1':                  text = '否';                  break;                default:                  text = '';                  break;              }              return h('span', text);            }          },          {title: '邮件通知', key: 'isEmail',minWidth: 60,            render: (h, params) => {              var text = '';              switch (params.row.isEmail) {                case '0':                  text = '是';                  break;                case '1':                  text = '否';                  break;                default:                  text = '';                  break;              }              return h('span', text);            }          },          {title: '操作', key: 'action', fixed: 'right',minWidth:160,            render: (h, params) => {              return h('div', [                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on: {                    click: () => {                      this.getTimeList()                      this.checkDo1AssociatedList(params.row)                    }                  }                }, '编辑'),                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on: {                    click: () => {                      this.delModal = true;                      this.delSn = params.row.sn                    }                  }                }, '删除'),                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on: {                    click: () => {                      this.choosedShareDevice = {                        sn:params.row.sn,                        deviceName:params.row.deviceName                      };                      this.modal3 = true;                    }                  }                }, '分享')              ]);            }          }        ],        columns2: [          {title: 'Device name', key: 'deviceName',minWidth: 120},          {title: 'Equipment SN', key: 'sn',minWidth: 130},          {title: 'Temperature warning range', key: 'temperatureScope',minWidth: 120},          {title: 'Humidity warning range', key: 'humidityScope',minWidth: 120},          {title: 'Reporting interval (hour)', key: 'historyInterval',minWidth: 120},          {title: 'Reporting time in history', key: 'historyReportTime',minWidth: 100},          {title: 'Recording interval', key: 'recordInterval',minWidth: 100},          {title: 'Reporting interval', key: 'reportingInterval',minWidth: 110},          {title: 'Belong to the region', key: 'regionalName',minWidth: 150},          {title: 'Power off alarm', key: 'isOutages',minWidth: 100,            render: (h, params) => {              var text = '';              switch (params.row.isOutages) {                case '0':                  text = 'YES';                  break;                case '1':                  text = 'NO';                  break;                default:                  text = '';                  break;              }              return h('span', text);            }          },          {title: 'SMS notification', key: 'isSms',minWidth: 100,            render: (h, params) => {              var text = '';              switch (params.row.isSms) {                case '0':                  text = 'YES';                  break;                case '1':                  text = 'NO';                  break;                default:                  text = '';                  break;              }              return h('span', text);            }            },          {title: 'Mail notification', key: 'isEmail',minWidth: 100,            render: (h, params) => {              var text = '';              switch (params.row.isEmail) {                case '0':                  text = 'YES';                  break;                case '1':                  text = 'NO';                  break;                default:                  text = '';                  break;              }              return h('span', text);            }          },          {title: 'operation', key: 'action', fixed: 'right',minWidth:180,            render: (h, params) => {              return h('div', [                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on: {                    click: () => {                      this.getTimeList()                      this.checkDo1AssociatedList(params.row)                    }                  }                  }, 'edit'),                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on: {                    click: () => {                      this.delModal = true;                      this.delSn = params.row.sn                    }                  }                }, 'delete'),                h('Button', {                  props: {type: 'text', size: 'small'},                  style: {                    color: '#2d8cf0'                  },                  on: {                    click: () => {                      this.choosedShareDevice = {                        sn:params.row.sn,                        deviceName:params.row.deviceName                      };                      this.modal3 = true;                    }                  }                }, 'share')              ]);            }          }        ]      }    },    methods:{      /*时区*/      getTimeList(){        let userId = this.$cookie.get('userId');        let accessToken = this.$cookie.get('accessToken');        let permissions = this.$cookie.get('permissions');        let data = {          userId:userId,          loginType:2,          accessToken:accessToken,          permissions:permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/public/getTimeCode",          data        },(res)=>{          let result = res.data;          this.timeList = result.data;        },(erro)=>{          console.log(erro);        })      },      initPage(it){        this.pageNow = it      },      goPage(it){       this.pageNow = it-1      },      confirmChooseArea(){        this.deviceChoosedArea = this.deviceChoosedAreaTemp;        if(this.deviceChoosedArea){          console.log(this.deviceChoosedArea)          this.editDevice.regionalId = this.deviceChoosedArea.regionalId;          this.editDevice.regionalName = this.deviceChoosedArea.title        }else{          this.editDevice.regionalId = ''        };        this.deviceAreaModal = false;        this.modal2 = true;      },      chooseToTheArea(it){        this.deviceChoosedAreaTemp = it[0];      },      changeThisDeviceArea(){        let userId = this.$cookie.get('userId');        let accessToken = this.$cookie.get('accessToken');        let permissions = this.$cookie.get('permissions');        let data ={          type:0 ,          userId:userId,          accessToken:accessToken,          permissions:permissions*1 ,          loginType:2        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/regional/getRegional",          data        },(res)=>{          let result = res.data.data;          let list = {};          let resultHandle = [];          result.forEach(function(val,index){            list = {              title:val.regionalName,              regionalId:val.regionalId,              upRegionalId:val.upRegionalId,              children:[]            };            val.childRegional.forEach(function(value,i){              list.children.push({                title:value.regionalName,                regionalId:value.regionalId,                upRegionalId:value.upRegionalId              })            })            resultHandle.push(list)          });          this.allAreaList = resultHandle;          this.deviceAreaModal = true;          this.modal2 = false;        },(erro)=>{          console.log(erro)        })      },      /*编辑保存*/      editSave(name){        this.$refs[name].validate((valid) => {          if (valid) {            const _this = this;            let userId = this.$cookie.get('userId');            let accessToken = this.$cookie.get('accessToken');            let permissions = this.$cookie.get('permissions');            let params = {...this.editDevice};            /*单独处理数组*/            let do1Associated = this.editDevice.do1Associated.toString();            let do2Associated = this.editDevice.do2Associated.toString();            let emailList = JSON.stringify(this.editDevice.emailList);            let smsList = JSON.stringify(this.editDevice.smsList);            let do1Status = this.editDevice.do1Status?0:1;            let do2Status = this.editDevice.do2Status?0:1;            let isOutages = this.editDevice.isOutages?0:1;            let sn = this.editDevice.snName;            params.do1Associated = do1Associated;            params.do2Associated = do2Associated;            this.editDevice.isEmail?params.isEmail = emailList:params.isEmail = JSON.stringify([]);            this.editDevice.isSms? params.isSms = smsList:params.isSms =  JSON.stringify([]);            params.do1Status = do1Status;            params.do2Status = do2Status;            params.do1Type = this.editDevice.do1Type*1;            params.do1Type = this.editDevice.do1Type*1;            params.isOutages = isOutages;            params.sn = sn;            let data = Object.assign(params, {              userId:userId,              loginType:2,              accessToken:accessToken,              permissions:permissions            });            delete data.theDo1AssociatedList;            this.$http({              method:'post',              url:this.$util.ajaxUrl+"/warning/updateDevice",              data            },(res)=>{              if(res.data.code==0){                this.modal2 = false;                this.$Message.success("保存成功")                this.$refs.topSearch.initDeviceList(0)              }            },(erro)=>{              console.log(erro);            })          }        })      },      /*确认分享*/      shareSave(name){        this.$refs[name].validate((valid) => {          if (valid) {            let userId = this.$cookie.get('userId');            let accessToken = this.$cookie.get('accessToken');            let permissions = this.$cookie.get('permissions');            let data = {              sn:this.choosedShareDevice.sn,              sharedAccount:this.shareDevice.account,              deviceName:this.choosedShareDevice.deviceName,              userId:userId,              loginType:2,              accessToken:accessToken,              permissions:permissions            };            this.$http({              method:'post',              url:this.$util.ajaxUrl+"/shared/sharedDevice",              data            },(res)=>{              let result = res.data;              if(result.code==0){                this.modal3 = false                this.$Message.success('分享成功!');              }else{                this.$Message.warning(result.msg);              }            },(erro)=>{              console.log(erro);            })          }        })      },      /*确认删除*/      delOk(){        this.delet(this.delSn)      },      /*取消删除*/      delCancel(){        this.delModal = false;      },      /*新增邮箱*/      addEmail(it){        if(it.length>5){          this.$Message.warning('邮箱不能超过6个!');          return        };        it.push({          name:'',          email:''        })      },      /*新增联系人*/      addContact(it){        if(it.length>5){          this.$Message.warning('联系人不能超过6个!');          return        };        it.push({          name:'',          phone:''        })      },      /*查询设备列表*/      choosedDeviceList(it){        const _this = this;         this.deviceList = [];         this.totalPage = it.count;         console.log(it.dataList)         it.dataList.forEach(function(val,index){          _this.deviceList.push({            sn:val.sn,            deviceName:val.deviceName,            temperatureScope: val.temperatureLow +'-'+val.temperatureHigh,            humidityScope:val.humidityLow +'-'+val.humidityHigh,            regionalName:val.regionalName,            isOutages:val.isOutages.toString(),            isSms:JSON.parse(val.isSms).length>0?'0':'1',            smsList:JSON.parse(val.isSms),            isEmail:JSON.parse(val.isEmail).length>0?'0':'1',            emailList:JSON.parse(val.isEmail),            deviceType:val.deviceType,            regionalId:val.regionalId,            timeCode:val.timeCode,            temperatureHigh:val.temperatureHigh,            temperatureLow:val.temperatureLow,            humidityHigh:val.humidityHigh,            humidityLow:val.humidityLow,            recordInterval:val.recordInterval,            reportingInterval:val.reportingInterval,            do1Associated:JSON.parse("["+val.do1Associated+"]"),            do2Associated:JSON.parse("["+val.do2Associated+"]"),            do1Type:val.do1Type.toString(),            do2Type:val.do2Type.toString(),            do1Status:val.do1Status.toString(),            do2Status:val.do2Status.toString(),            historyInterval:val.historyInterval,            historyReportTime:val.historyReportTime,            humidityBuffer:val.humidityBuffer,            temperatureBuffer:val.temperatureBuffer,          })        })        console.log(this.deviceList)      },      checkDo1AssociatedList(it){        const _this = this;        let userId = this.$cookie.get('userId');        let accessToken = this.$cookie.get('accessToken');        let permissions = this.$cookie.get('permissions');        let data = {          sn:it.sn,          userId:userId,          loginType:2,          accessToken:accessToken,          permissions:permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/warning/getWarningStatus",          data        },(res)=>{          let result = res.data.data;          this.edit(it,result)        },(erro)=>{          console.log(erro);        })      },      edit(it,theDo1AssociatedList){        this.editDevice.theDo1AssociatedList = theDo1AssociatedList;        this.editDevice = {             snName:it.sn,             regionalId:it.regionalId,            regionalName:it.regionalName,            deviceName:it.deviceName,            timeCode:it.timeCode,            temperatureHigh:it.temperatureHigh,            temperatureLow:it.temperatureLow,            humidityHigh:it.humidityHigh,            humidityLow:it.humidityLow,            reportingInterval:it.reportingInterval,            recordInterval:it.recordInterval,            isOutages:it.isOutages=='0'?true:false,            isSms:it.isSms=='0'?true:false,            smsList:it.smsList,            isEmail:it.isEmail=='0'?true:false,            emailList:it.emailList,            do1Associated:it.do1Associated,            do2Associated:it.do2Associated,            deviceType:it.deviceType,            theDo1AssociatedList:theDo1AssociatedList,            do1Type:it.do1Type,            do2Type:it.do2Type,            do1Status:it.do1Status=='0'?true:false,            do2Status:it.do2Status=='0'?true:false,            historyInterval:it.historyInterval,            historyReportTime:it.historyReportTime,            humidityBuffer:it.humidityBuffer,            temperatureBuffer:it.temperatureBuffer          };          this.modal2 = true;      },      delet(it){        let userId = this.$cookie.get('userId');        let accessToken = this.$cookie.get('accessToken');        let permissions = this.$cookie.get('permissions');        let data = {          sn:this.delSn,          userId:userId,          loginType:2,          accessToken:accessToken,          permissions:permissions        };        this.$http({          method:'post',          url:this.$util.ajaxUrl+"/warning/deleteDevice",          data        },(res)=>{          let result = res.data;          this.$refs.topSearch.initDeviceList(0);          this.$Message.success('设备删除成功!');        },(erro)=>{          console.log(erro);        });      }    }  };</script>